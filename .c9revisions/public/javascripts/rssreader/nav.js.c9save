{"ts":1369894961331,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1369894875965,"patch":[[{"diffs":[[1,"enyo.kind({\r\n    name: \"reader.fragment.NavPanel\",\r\n    kind: \"Panels\",\r\n    events: {\r\n        onShowArticlePanel: \"\",\r\n    },\r\n    classes: \"panels enyo-fit panel-nav\",\r\n    components: [\r\n        {kind: \"reader.fragment.Feeds\", name: \"feeds\", onShowArticlepanel: \"showArticlePanel\"}\r\n    ],\r\n    refreshFeeds: function(feeds){\r\n        this.$.feeds.refreshList(feeds);\r\n    },\r\n    refreshTags: function(tags){\r\n        this.$.feeds.refreshTagList(tags);\r\n    },\r\n    showArticlePanel: function(inSender, inEvent){\r\n        this.doShowArticlePanel();\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragment.Feeds\",\r\n    kind: \"FittableRows\",\r\n    events: {\r\n        onShowArticlepanel: \"\"\r\n    },\r\n    components: [\r\n        {\r\n            kind: \"FittableRows\",\r\n            fit: true,\r\n            components: [\r\n                {\r\n                    name: \"feedTagPanel\",\r\n                    kind: \"Panels\",\r\n                    classes: \"panels\",\r\n                    arrangerKind: \"CardSlideInArranger\",\r\n                    fit: true,\r\n                    components: [\r\n                        {name: \"feedlist\", kind: \"reader.fragments.FeedList\", onSelectFeed: \"selectFeed\"},\r\n                        {name: \"taglist\", kind: \"reader.fragments.TagList\", onSelectFeedTag: \"selectFeedTag\"}\r\n                    ]\r\n                },\r\n            ]\r\n        },\r\n        {components: [\r\n            {kind: \"reader.fragment.NavigationToolbar\", onTogglePanel: \"togglePanel\", onShowAddPanel: \"showAddPanel\", onShowArticles: \"showArticles\"},\r\n        ]},\r\n        {\r\n            name: \"addPopup\", kind: \"reader.fragment.AddPopup\", onTapAdd: \"tapAdd\"\r\n        }\r\n    ],\r\n    refreshList: function(data){\r\n        this.$.feedlist.feeds = data;\r\n        this.$.feedlist.refreshList();\r\n    },\r\n    refreshTagList: function(data){\r\n        this.$.taglist.tags = data;\r\n        this.$.taglist.refreshList();\r\n    },\r\n    togglePanel: function(){\r\n        if(this.$.feedTagPanel.index === 0)\r\n            this.$.feedTagPanel.next();\r\n        else\r\n            this.$.feedTagPanel.previous();\r\n    },\r\n    addFeed: function(inSender, inEvent){\r\n        socket.emit('add feed', {url: inEvent.url});\r\n    },\r\n    showAddPanel: function(){\r\n        if(this.$.feedTagPanel.index === 0){\r\n            this.$.addPopup.setPlaceholder(\"Input Feed URL\");\r\n        }else if(this.$.feedTagPanel.index === 1){\r\n            this.$.addPopup.setPlaceholder(\"Input Tag Name\");\r\n        }\r\n        this.$.addPopup.show();\r\n    },\r\n    tapAdd: function(inSender, inEvent){\r\n        if(this.$.feedTagPanel.index === 0){\r\n            socket.emit('add feed', {url: inEvent.value});\r\n        }else if(this.$.feedTagPanel.index === 1){\r\n            socket.emit('add tag', {name: inEvent.value});\r\n        }\r\n    },\r\n    showArticles: function(inSender, inEvent){\r\n        this.doShowArticlepanel();\r\n    },\r\n    selectFeedTag: function(inSender, inEvent){\r\n        this.$.feedlist.resetSelections();\r\n    },\r\n    selectFeed: function(inSender, inEvent){\r\n        this.$.taglist.resetSelections();\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragments.FeedList\",\r\n    events: {\r\n        onSelectFeed: \"\",\r\n    },\r\n    components: [{\r\n        name: \"list\",\r\n        kind: \"List\",\r\n        classes: \"list-feeds-list\",\r\n        count: 0,\r\n        onSetupItem: \"setupItem\",\r\n        components: [\r\n            {\r\n                name: \"item\",\r\n                classes: \"list-feeds-item\",\r\n                ontap: \"itemTap\",\r\n                components: [\r\n                    {\r\n                        name: \"name\"\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }],\r\n    feeds: [],\r\n    setupItem: function(inSender, inEvent){\r\n        var i = inEvent.index;\r\n        \r\n        this.$.name.setContent(this.feeds[inEvent.index].name);\r\n        this.$.item.addRemoveClass(\"list-feeds-item-selected\", inSender.isSelected(i));\r\n    },\r\n    itemTap: function(inSender, inEvent){\r\n        var i = inEvent.index;\r\n        \r\n        socket.emit('load feed articles', {feed: this.feeds[i]});\r\n        socket.emit('load feed tags', {feedId: this.feeds[i]._id});\r\n        \r\n        enyo.Signals.send(\"onChangeArticleSource\", {name: this.feeds[i].name});\r\n        \r\n        this.doSelectFeed();\r\n    },\r\n    refreshList: function(){\r\n        this.$.list.setCount(this.feeds.length);\r\n        this.$.list.refresh();\r\n    },\r\n    resetSelections: function(){\r\n        for(var i=0; i<this.feeds.length; i++){\r\n            this.$.list.deselect(i);\r\n        }\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragments.TagList\",\r\n    events: {\r\n        onSelectFeedTag: \"\",\r\n    },\r\n    components: [{\r\n        name: \"list\",\r\n        kind: \"List\",\r\n        classes: \"list-tags-list\",\r\n        count: 0,\r\n        onSetupItem: \"setupItem\",\r\n        components: [\r\n            {\r\n                name: \"item\",\r\n                classes: \"list-tags-item\",\r\n                ontap: \"itemTap\",\r\n                components: [\r\n                    {name: \"name\"}\r\n                ]\r\n            }\r\n        ]\r\n    }],\r\n    tags: [],\r\n    setupItem: function(inSender, inEvent){\r\n        var i = inEvent.index;\r\n        \r\n        this.$.name.setContent(this.tags[inEvent.index].name);\r\n        this.$.item.addRemoveClass(\"list-tags-item-selected\", inSender.isSelected(i));\r\n    },\r\n    itemTap: function(inSender, inEvent){\r\n        var i = inEvent.index;\r\n        \r\n        socket.emit('load tagged articles', {tag: this.tags[i]});\r\n        enyo.Signals.send('onChangeArticleSource', {name: this.tags[i].name});\r\n        this.doSelectFeedTag();\r\n    },\r\n    refreshList: function(){\r\n        this.$.list.setCount(this.tags.length);\r\n        this.$.list.refresh();\r\n    },\r\n    resetSelections: function(){\r\n        for(var i=0; i<this.tags.length; i++){\r\n            this.$.list.deselect(i);\r\n        }\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragment.AddFeedBox\",\r\n    kind: \"onyx.MenuDecorator\",\r\n    events: {\r\n        onAddFeed: \"\"\r\n    },\r\n    components: [\r\n        {kind: \"onyx.Button\", content: \"aaa\"},\r\n        {\r\n            kind: \"onyx.ContextualPopup\",\r\n            title: \"Add Feed\",\r\n            components: [\r\n                {name: \"textArea\", kind: \"onyx.TextArea\"},\r\n                {kind: \"onyx.Button\", content: \"Add\", ontap: \"addFeed\"}\r\n            ]\r\n        }\r\n    ],\r\n    addFeed: function(inSender, inEvent){\r\n        this.$.contextualPopup.hide();\r\n        this.doAddFeed({url: this.$.textArea.getValue()});\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragment.NavigationToolbar\",\r\n    kind: \"onyx.Toolbar\",\r\n    classes: \"toolbar\",\r\n    events: {\r\n        onTogglePanel: \"\",\r\n        onShowAddPanel: \"\",\r\n        onShowArticles: \"\"\r\n    },\r\n    components: [\r\n        {kind: \"onyx.Button\", content: \"+\", ontap: \"test\"},\r\n        {kind: \"onyx.Button\", content: \"<>\", ontap: \"togglePanel\"},\r\n        {kind: \"onyx.Button\", content: \"<\", ontap: \"showArticles\"},\r\n    ],\r\n    togglePanel: function(){\r\n        this.doTogglePanel();\r\n    },\r\n    test: function(){\r\n        this.doShowAddPanel();\r\n    },\r\n    showArticles: function(){\r\n        this.doShowArticles();\r\n    }\r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragment.AddPanel\",\r\n    components: [\r\n        {kind: \"onyx.Button\", content: \"Add\"}\r\n    ]    \r\n});\r\n\r\nenyo.kind({\r\n    name: \"reader.fragment.AddPopup\",\r\n    kind: \"onyx.Popup\",\r\n    events: {\r\n        onTapAdd: \"\"\r\n    },\r\n    centered: true,\r\n    modal: true,\r\n    floating: true,\r\n    components: [\r\n        {kind: \"onyx.Input\"},\r\n        {kind: \"onyx.Button\", content: \"Add\", ontap: \"tapAdd\"}\r\n    ],\r\n    tapAdd: function(){\r\n        this.doTapAdd({value: this.$.input.getValue()});\r\n        this.$.input.setValue(\"\");\r\n        this.hide();\r\n    },\r\n    setPlaceholder: function(placeholder){\r\n        this.$.input.setPlaceholder(placeholder);\r\n    }\r\n});\r\n"]],"start1":0,"start2":0,"length1":0,"length2":7871}]],"length":7871,"saved":false}
